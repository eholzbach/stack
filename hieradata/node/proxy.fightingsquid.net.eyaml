classes:
  - haproxy
  - nrpe::services::haproxy
  - nrpe::services::tor
  - ops_firewall
  - tor

puppetmaster: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEALTXAyBFOQLd+opyRUhGEeKFZUcqjZyquTW8Mea4IV0BhkvF/bGjg3GsFsl40Mtm1p0gv+VR6g2F6fIhyLygV3JphNTAuO45urxLwJTuLzrOOZPLpgG/NUw2gVhFhGlZ++NteN8zqEuv5CnWr0evoMHeUGV5qK9VQWDO6wseuUdLSQqZDMRU3tpu49qbw9Mx34zFnimVHhZ9WgSZpQEMer0iKY7HTXiVo2+t4+yRlkG6kQOMtHbwh8hs5CDDSgIxwsM6dGtpHASjPAPwSLNMxnh8bF+2nBpE7Fd5JGQBoo6ih/eF2YXnOvSuX+fM0zfIBVdjajQeImjD/eoCtG7EnHjA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBBkzasa4CtD98UNtOA6pL2mgBCS9CDJR2qUaph+FDyVlPLg]
syslogserver: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAVr0gWW8zRkdizhYKXDBxOFLaU7xlXr/bpsqAOzT8OrU4lxx73+mf86GoGRTmrLPsY+2nxWnxy0auBS6xYAQWsvC/zU0GD++J7wPNAdS+pvhPnHsM/4N/PFVhXTaHVxf8n9FL/2LFpJmz/BnfOFNWv2LxPi9A/rBePDyuqIChweIhcjb+ko8lqPCUtAKUis6Q7d/FJMn093V7o/4OatGMl4i8tVH+JONMeJrROvWyc0ONFO4nXypgEdVjIgl77g+iFDsyER3ikXrANPvp7A5+uPzfp49yI89YItD5moYhF+4iAyPG505gLJsJ2DJm9+U+rBYzRZC87jKmCDhSjBxjYDA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDd12ZMPbGHuQgcpptDZy5KgBDYiZN2Y4JyVeJt31z5FeTc]
 
ops_firewall::rules:
  '100 allow to puppetmaster':
    port:
      - 80
      - 443
      - 8140
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEALYBy/TgOYYkKuP+k/vtWdOvqix3dPb7CqFeQnS8p36PZoqNuUIww+vDH64eWpu1PXJrbnwfNNwRLIXhBEiXKAB9IgaBRojAEB29CfW+9o1uEUoRItgTbcN5IgTktZzugwS3AxEY8to5EdA0L+lJTbQE1ZsoT+1JN0RQqvC8MXSzXROOCIwpVeKczGXQaSDqz4D3QCUbTouF9s00q2Eq6aIuSX024KMKilKFFGDOP9R6COgKehLvkHj9m+q1DgwmkCJL9ve+yz9y6u98+T3jpDZWtrxa3ME8aT0afw3j84xCk0V96WVhysTuyvOrOqrqusjuhNtNAzkNePMuiO6R4uTA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBA2Mhlkro9vJU4wSuBJjhkMgBDbA0Na6A5OWi0kP+holw7n]
    action: accept
  '101 allow to puppetmaster':
    port:
      - 80
      - 443
      - 8140
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAhWgjSd5Pv/n9sLDjKuILbpYlro3DDubzbVqxTKAnriPnRkwGOtahcs31CoMAg9blEdwbWx/No2nhg5qmIq2EE52pyErX47u3r4z0Ne2oNbg+8Rbj/P5ZOmSgavp/uPoH/v2G6xBAUbkC+TMzoQFZcLF6nuf4bC1vIUEQqzvEWgcX1iugKMb95lgz5G4o7kQPyq0oYp0mEuFFZrHK+l5taAL8+KBpg4gLqYgOUDpupsR85a/Zaa/4w+v2wIW1S/U71Buz1UsQzxkCpNGqr8DV9P5OrbNbEA47uLYtFx5omyIFU8hIYjmy/MfcxRVFmVx2pcNhkQNSaLUP577hixRJNjA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBCo0SkgM3vyh4sC7S55c2BpgBA5m8qzy7RqP8AJQhrQvB1i]
    action: accept
  '102 allow to puppetmaster':
    port:
      - 80
      - 443
      - 8140
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEASW47us0RZjqgXJjL5UNBdX0bUXCtM/0XXUPb+Y/WrRmThqhkr5tYSFahwAyXAu/LU7DRsDXu1slX46Yqi144SmxzmIZCPikK7KAkNVasSeehdG+KnOt2WvMIrIoxPSsPl9uoyfYMTzaSSzI1ak+6WsNK4uVUJX/qEC6ONVqjF0f6ZCfyJlZzmGp90drBs7xTsorOJbIP4rYAvPJVNOxLnt9mDlElLTfx+Ot33DtnTzkf9Jduj64qHMMepNEuZkYaQvFUAfF7nmNdXnRyGQr2Wt/TJYebi+Mqnq8UbCc9+Um5a3u+pkoVEKRlqgSs4BITn/5/ISbMV5IGhdwN2BRj+TA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDl9vxDVTQVhA1u/Gn9A0bogBDJVhq0Zh1LhgH98Qpn5c2y]
    action: accept
  '103 allow to puppetmaster':
    port:
      - 80
      - 443
      - 8140
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAuUs9LPne+Gx5knsOmaYuWBEIcWskgMs4bo4KV2uJQPA687F665nEYAwkNJLCSVsDGRRWVU9IOtdoW+FwITKw12u20NKMD/DiMq0IXXkXmWvKaiyfa/U0ybZmDPS4IDAJrE9PMzf7FP2zNJksFTpABsC7WpJegK5W3jZrdUpFqNUk9KJggGsPD3qgPcGFcvYYsNTkwoh2QITBTlhYngmNw5Pbe4BvURj384ZpR2ePnpMHOEsq8jkxacGMwgtjaqDS67p2oq6gOfh/WtPDQIwTTgk56tPVuuM6BIHXol5F/nwzyk7n3eubzBBiwRIyD4Gh5nx5xujJTuXv5kLjasZY8zA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBAxsyr6T0EJNA9WfizOrDN0gBAUntmzxR28y31ArAbKjN2V] 
    action: accept
  '104 allow to puppetmaster':
    port:
      - 80
      - 443
      - 8140
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAwpzfbsPm1bCw3sq5/V+1lmcB1ruPqozhe+C54v8X9Vcnjp8YBzofcElJu7RIR3z1coDlAvkPLVSwtycWVCBxkUPd2jdhW9oPpqo2WRL+a9/k3IzjSHY2osBX560JznPwfEwRm4TMyVOz4idvYdFx/nx6LMKRJylUXZH4HX+sdMWrXuES9ka+T9tbl08/bpiliNxNUTjzDMxvTroG865rsC35nkWZKEnoi5JB54zuWRCKRqfjzqBpy1475GwGco/hO1w/QPn0E3XTnJazaRDFTofG8pBuCiHdmDn0Phe4pZEPe5N0pLN8+9Q+JT0If4P2SNfzYyTzge9I2KlKdKMz/TA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDrw0hiPt+B6reBd58RF//9gBD15VJNifFe98JG8ysWP0QP]
    action: accept
  '105 allow to puppetmaster':
    port:
      - 80
      - 443
      - 8140
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEApCjxdrJbXf8+sVvNAnT9oBgXdMRTXNUe/Qp30ZnaYHcIp5D07dRzvyygIJ7A3wgthoJnEPKln8JsMpHs6ACUYoB32wQ7L2UekHvREqBS//OJI2LTPFl/44sjulTqfo0rBKqukEobH/Yu/3IVanwCnG3eCiYRAWyOnUW7nMSbq1MPlsIGIhQYNidzvZO6/KCIh3RXGBTslKB798biqGxpLXtvX/UwNQvBx2Y/agCORYJfCCMOru6EyhGz8G4NEyo8UJQ0Us2mc70WPgAKAFfd8h7dDamtqIVrPRg6e931cz9LJsby6L01dI7BxjNCejs9/kUAia5l1XrnNtkDq7qLWzA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBB70OW6KueAcuCL76/D8KgPgBD2NBZFleexf+Xacyfa0E5Q]
    action: accept
  '106 allow to puppetmaster':
    port:
      - 80
      - 443
      - 8140
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEArGHt2auLLIhebEZ1cSfKm6aeSeriJf8CtxhF6hExPfzjG7kGZxFnxCZFco68YA4dqsgWtBszkZwFlXWKKIphEsNYBs0b2KMxrCStR70f1+St284pzgpT9h4iE7szTaaOHXxo5O6dvuRU+Tt0mp29moDNqxi4TvQ9prLAy1WgJyeegazCO1ql/tgXc4yxECMTF7WNxbeI891jYUcxEt/2CYwe0QG/rr6epxwD/jDXfar/B8qgNCjiOUFzmHAyZCxYND0lxDHIWoGoH0OfLJeNYa7iycJ0xIL/EHxsRJiaT9bjy76Fx38+XubGbdkGB8a46Lz4/IYl0BZAA0cpl918cTA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDncP3lD9qX2nyvuOWN3LVAgBA+pdZbQ1vJV4dSQ5hArzDN]
    action: accept

  '107 allow to syslog':
    port:
      - 514 
    proto:  tcp 
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAbTlLZLmQnx5v9QXZHjKsvjcfVWweSLDEmHnhLMVBgGytHhdV0nKjc72ygRd9cKy0zbBd2XaelpVaj0dnc4D9HIpMbH9rekLOyWBB/H4CNZ3INV3nPHNTihVtFbAu5qA4d96NVckS/Uj2J07Zp912ls51KiSaDtY3TcpyJHdg54jr/y98y2TPVdepf3z82UsmenN48uY2pT+nPsEDj9yKwiMNMJ8z253jOTonvohhWaqPH+Cv4tmWbDw33vt65kAdRsQpu9ANNf224KU39Qm/2xmBaZvODF5daCwtDyAyRXrnx/fOIBRhjlq6zZ9mNavf1V/wnWzYogQkRun7PTHvZDA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBBQXI+vgJsPSrHUp0AWrN9VgBAXeAIVgj8Zms/tvwoXo6m7]
    action: accept
  '108 allow to syslog':
    port:
      - 514 
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAnqHpn0l0BwTSjcujkWZy8O/1W7Yg715pHoXuX0+oQiE/VdejTeUGGEp40JqzVM/tWwCZhiRa7vsrzjxu+u8VJY7aHXSCISTYqtcldqpQjiRra4QHX0nO5auMHb5Q++HWEk3AQo2lZdfD/YtUGaFPE1xHbNdySZmekhcyetcorH28MqJq5kaiAM4xnZsbecaAaX36uTBNi/SZ6YDHXjL5yAkfyHZd4nUEV7Hx24Tc7JuiZ14UJ1T2wq7DS9LrAOpnRWj0YMyLEemFXEfNMUHRHAegBezNYYsWNvDeyjzhEzv1694Kbe8Wt20zG2QCKMC1kJ/7E+S0PHLbP4CVe/GjKjA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBBTE3nKUKU+wt/WY+rm+horgBBHJqXnC/ccoTS8gY62EdWT]
    action: accept
  '109 allow to syslog':
    port:
      - 514 
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAY6YaHsZz7vuZfiRohPIvov4U8kTYWdhm82opcvBXpYMew25R43/Djab3hVFbbe/5G+5BzmsOXynVYPn/5W6dUh1XAqHFUFr3d+LGh+uEdVA5Y0ENH+vev+hMsRcBh8si+3mzYzaHt/vxbMp/qr9vB53j/3ZngVT0Jp+W/lqfN3vVspr32FRvniR4Zo3Eru6CRWY2WYBKmkFn9PuCs6E3Y0mCxJ+zhXi41dRMs0z2jMJiLcVOil6Iqj85SgCZgeYkVEqkeckFs+9WrxpYU1lNK5nK2vPXzmCBLs6FfhvxziH6p2DryPAu2RDnWQ8/HPHpr+gb5VhFGzbI3iWIt8H9HjA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBB3zhq9pJHkhBahYuIhhZQsgBCF711Y/LENCGVE5Go35XXd]
    action: accept
  '110 allow to syslog':
    port:
      - 514
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAxILoapcp1sYXbX6sOlKlpdm2yUSTw71QUMlGVq3Uz5jak1Q86RNxnn1JfnAE9fLT7wochYQLOyO/VZ4j6R8cnyAvyalKs09H3Hg8aY8uAg15CWWDC3q9GZUWp68hUfr2kcakP/HoGC+WTDtX1e9URU8X0/8e42XpgXh81aj0GG+SkdvIpzBt9nPoyJraeigiTc1QEdFIlbKa0oyDSpwNQfKqRgLpBp5/uu/Axas1s+w3hhWOS2hAggCYAC+jP5ohfBc2WOP7FAElQFr5EYFo6IiPwDUbKqzrAVvVpi7SyvXWiUq3na3DpmFl2ZG5DU6icHP7Pdgk9iuNmOlpCrjC7DA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBA1ZfDjFJQxY1RzSmwtQFTugBD6esahlr+yciWSn4M5iqCD]
    action: accept
  '111 allow to syslog':
    port:
      - 514 
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAIn+6yAceKfhWeSmUqj2x0X8AyP0ktIF8OvfiL/ERjzU+P1dGkYPzTPQEaij5y5L/kcoyrXvXkcUpuDtoSb7pLrVbmJmCSXXXZpY9AWEdbUIrc0OYGQM6ea9yFYlOXmqNnmlGjXwznsP18a2/QwlS2VVjujX0Vim6RExfIMzHHchWyJujA9IHx/G5BoJk84gCLetcoPj5coxaFIPuQTumWfNITxPbj/sci03cbTNHiSzmpB7Bo6VtyDN+JLkrgz6EWAZ6ezg0Y6lHLCGGIPAqjw7C66wNa8pUbPgHw2yy0xK65pwseePl4tdBPIp+o7EfRWMjK11T+EHA984VqVxX0TA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBAWz6q3QkSez9xi3y8vpWs1gBBPMS2lJ7rIAH2QgNrEWzuO]
    action: accept
  '112 allow to syslog':
    port:
      - 514
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAIEeeiRZ+JBPj+KXaHBawqDTfSojPmLzeHV3VSKfikEhv+nS3oxeWYljD21mmLNg1aUx7xs6VIYc2uqWuEHGcVJ/sp5J0GzCw9qIM9HilNcoUuYREI0Hq6bjQL5zdIvGWZkVz5ubUTAN961iDMBj3qrlVh43RWtkmWKt37x4w53xqmZtmcrVeUWrheR1/CL0USr8Ctu1Whtr9uhIqUeBwMZkPa9vooWflxwLEhq35ZBUX7duiDBHv09ZP9peTZN4NML8eiws8k0EchYvGc9pQZq+K4f0ZOnESnCvYKOdrwM2dIOO3M75XEY6oY+S9q170zQwDPwGIovjhd8YJhgOimzA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDHHf0VBxc7IffL2P01Mp4mgBDjRK+pa/CAqpCp8A1OO+f4]
    action: accept
  '113 allow to syslog':
    port:
      - 514 
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAPdck6sWQ5x8DQyDMIpjPb9DdqNkQ005L8TIBAySh88eHeLVXlhhZPiQrPh0GCRZyxKc3xxrPhCduKN1Qdm9owtjXZz61djEWOC4B+YmIEyjLFUWwd4EN/pumfFGZlNYYcPt9D/QH3pU/ieWKNizL9NDedAOvpxw609drzjp+z4rdehT+v+GLAOSkpgG62mZnPZiBx6+TftWOUVBb6k17TFlIWhjX0JNxtbMDn2rXQDiby34Ulf6ofaA7dYpbbFnaPZgwFHLI9CZ5vSmB/VtBTLyTuHA4bHD42zUvMBK6lH3rr71/pQCedF3/5cK72HrsRbTjadJxF4sQ9KaneJO8FjA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDWU309v1Y7zW2BN36K/z+lgBC4cmUJ8VOEAXXDIJTvEOgO]
    action: accept
  '114 allow to tor':
    port:
      - 9050
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAsljwZfYZnRLQY0vHi5NwBURoxXDVxzu5kNhDEjb8uE6PlxOGV/QuL7bYODLEkmDDb8yhHDG8uRdhVbyjUvnp2GrRA0ERs/sfRQzytNDYc5+5C0a9MSky0t/lVa2pfo6SDdjKWevYAnBFod3SvZkyrzkJx7v9cMzIxIFOveIIp7NEtCne1QmkpMiKdg5dRR2VdNFeRLTmcdj8lQVKfnsk56eKuhIxz318vxZ2trgIJ7GTC6EQTVzyu3f8As+23RABe57jMlcKEeZtdBIyoH91zbCu+DiY6AaqTq/cZ7zlXx833Zc6yoHVP2KDVfKX22w7WWpaXqhKt7HFuHI/972CSTA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBCfBThi3ZBTOpbm+C6WWEtBgBAz3/okL4y8izqFc124GG9F]
    action: accept
  '115 allow to tor':
    port:
      - 9050
    proto:  tcp
    source: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAqGnqlIH1ZsqyBgIAGcZO5pSokYW1DGAAaUUInJEs/sFKWvSHdPWmflzxnS2Q2I8BAMp3TDRctoYGDkjW2MOsR6wPsLA1h2OSiPDqq7ELUr3qzUfmSL9a23Ihl4vg4rmph+0CMkIlswlo///KihCbWu0vlUBmAsEHIfYxWNKdVSehlqu9HhlB4JZeYL0BQGFbcjgl8yJaxsoIHeIbU42kzDi7KAAY332CB5QpNepJEP+WDE1ERC0sYD31QizgYnHpKhFe0lG1B+ZMUOMZNJ24COn6s8Dr/ptpybytIybeV8kAfrO4A4gGQcO/ZNf//N2rlvDoQ7ASq6MqPzSqNxBObzA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBAGSq254Zsb72M9bZARB+KXgBD30c0T9eAArX8bbd4SdPJQ]
    action: accept
